# Product Requirements Document — ExcelAI Add-in

## Purpose

Let users query and analyze Excel data using natural language, directly inside Excel. The AI assistant appears in a task pane and responds with summaries, formulas, chart suggestions, and insights.

## Problem Statement

Modern Excel users struggle with:
- Creating formulas from scratch
- Generating pivot tables or charts
- Running quick analysis without switching tools

This tool solves that by embedding AI support into Excel, so users stay in context.

## Target Users
- Analysts and finance teams
- Students and educators
- Operations and admin teams using spreadsheets for reporting

## Goals

| Goal                         | Description                                           |
|------------------------------|-------------------------------------------------------|
| Native Excel Integration     | Sidebar-based chat interface via Office.js           |
| Natural Language Input       | User can ask: “Show me top 5 products by revenue”    |
| AI-Powered Responses         | Use OpenAI to generate formulas, summaries, charts   |
| Safe and Responsible Use     | Guardrails against dangerous prompts or responses    |

## MVP Features

| Feature                  | Description                                                              |
|--------------------------|--------------------------------------------------------------------------|
| Excel Task Pane UI       | Chat interface built using HTML/CSS/JS or React                         |
| Range Selection Support  | User selects a cell range for context                                   |
| OpenAI API Integration   | Backend fetches GPT response using selected data                        |
| Insert into Sheet        | Formulas or summaries inserted via Office.js                            |
| Prompt Moderation        | Blocks unsafe or unsupported prompts                                    |
| Response Validation      | No macros, no deletion commands, only formula/chart output              |
| Session History          | Show last 5–10 prompts in sidebar                                       |

## Technical Design

**Frontend**:
- Built using Office.js APIs
- HTML/JS or React-based sidebar interface
- Hosted over HTTPS (Replit, Netlify, or GitHub Pages)

**Backend**:
- Node.js API or Flask (depending on reuse from main project)
- Handles prompt + selected data, sends to OpenAI API
- Applies prompt filtering and output validation
- Returns JSON response with plain text, formula, or chart logic

**Excel Integration**:
- Uses Office.js to:
  - Read selected range
  - Insert formulas/charts
  - Trigger AI prompt with context

## Guardrails

| Type              | Mechanism                                                            |
|-------------------|----------------------------------------------------------------------|
| Input Filtering    | OpenAI moderation API, keyword blocklist, input length limit         |
| Output Filtering   | Block formulas with deletions, macros, external URLs                 |
| Rate Limiting      | User throttling to avoid abuse                                       |
| Data Privacy       | Only selected range is sent to backend. No persistent logging.       |
| Disclaimer         | “No data is stored. AI responses are not guaranteed accurate.”       |

## Deliverables

- Manifest.xml file for sideloading
- React/JS sidebar UI
- Secure backend API with GPT logic + filtering
- Excel test sheet with example prompts
- Setup docs and limitations

## Success Metrics

- Add-in installed and used by 50+ users within first month
- Average session time > 2 minutes
- Prompt response time < 20 seconds for 90% of requests
- Formula accuracy > 90% (manual validation)

## Limitations

- Office.js cannot insert VBA or access macros
- GPT can hallucinate — results must be reviewed
- Replit or other free hosting unsuitable for production
- Fine-tuning or Copilot integration deferred for now

## Future Features

- Dashboard auto-generation from data
- Voice input to chat pane
- Role-based access control
- Admin console to configure rate limits and permissions
- Copilot-style inline suggestions